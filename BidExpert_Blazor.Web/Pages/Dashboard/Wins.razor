@page "/dashboard/wins"
@layout DashboardLayout
@attribute [Authorize]
@using BidExpert_Blazor.ServiceDefaults.Dtos
@using BidExpert_Blazor.Web.Services.HttpClients.Interfaces
@inject IUserClientApiService UserApiService

<PageTitle>Meus Arremates - Painel BidExpert</PageTitle>

<h1 class="text-2xl font-semibold text-gray-800 mb-6">Meus Arremates</h1>

@if (wonLots == null)
{
    <p>Carregando seus arremates...</p>
}
else if (!wonLots.Any())
{
    <p>Você ainda não arrematou nenhum lote.</p>
}
else
{
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        @foreach (var lot in wonLots)
        {
            <div class="border rounded-lg shadow bg-white p-4">
                <h3 class="font-semibold text-lg">@lot.Title</h3>
                <p class="text-green-600 font-bold">Arrematado por: @lot.Price.ToString("C")</p>
                <NavLink class="text-orange-500 hover:underline mt-2 inline-block" href="@($"/lots/{lot.PublicId}")">Ver Detalhes</NavLink>
            </div>
        }
    </div>
}

@code {
    private List<LotDto>? wonLots;

    protected override async Task OnInitializedAsync()
    {
        wonLots = await UserApiService.GetMyWonLotsAsync();
    }
}
