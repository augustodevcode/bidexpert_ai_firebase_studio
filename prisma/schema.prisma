// datasource and generator should be defined first
datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  output   = "./node_modules/@prisma/client"
}

// Enums
enum AccountType {
  PHYSICAL
  LEGAL
  DIRECT_SALE_CONSIGNOR
}

enum UserHabilitationStatus {
  PENDING_DOCUMENTS
  PENDING_ANALYSIS
  HABILITADO
  REJECTED_DOCUMENTS
  REJEITADO
  BLOCKED
}

enum AuctionStatus {
  RASCUNHO
  EM_PREPARACAO
  EM_BREVE
  ABERTO
  ABERTO_PARA_LANCES
  ENCERRADO
  FINALIZADO
  CANCELADO
  SUSPENSO
}

enum LotStatus {
  RASCUNHO
  EM_BREVE
  ABERTO_PARA_LANCES
  ENCERRADO
  VENDIDO
  NAO_VENDIDO
  RELISTADO
  CANCELADO
  RETIRADO
}

enum AssetStatus {
  CADASTRO
  DISPONIVEL
  LOTEADO
  VENDIDO
  REMOVIDO
  INATIVADO
}

enum AuctionType {
  JUDICIAL
  EXTRAJUDICIAL
  PARTICULAR
  TOMADA_DE_PRECOS
  VENDA_DIRETA
}

enum AuctionMethod {
  STANDARD
  DUTCH
  SILENT
}

enum AuctionParticipation {
  ONLINE
  PRESENCIAL
  HIBRIDO
}

enum ProcessPartyType {
  AUTOR
  REU
  ADVOGADO_AUTOR
  ADVOGADO_REU
  JUIZ
  ESCRIVAO
  PERITO
  ADMINISTRADOR_JUDICIAL
  TERCEIRO_INTERESSADO
  OUTRO
}

enum PaymentStatus {
  PENDENTE
  PROCESSANDO
  PAGO
  FALHOU
  REEMBOLSADO
  CANCELADO
  ATRASADO
}

enum DirectSaleOfferStatus {
  ACTIVE
  PENDING_APPROVAL
  SOLD
  EXPIRED
  RASCUNHO
}

enum DirectSaleOfferType {
  BUY_NOW
  ACCEPTS_PROPOSALS
}

enum DocumentTemplateType {
  WINNING_BID_TERM
  EVALUATION_REPORT
  AUCTION_CERTIFICATE
}

enum DocumentStatus {
  NOT_SENT
  SUBMITTED
  PENDING_ANALYSIS
  APPROVED
  REJECTED
}

// Models
model Tenant {
  id              BigInt           @id @default(autoincrement())
  name            String
  subdomain       String           @unique
  domain          String?          @unique
  users           UsersOnTenants[]
  platformSettings PlatformSettings?
  auctions        Auction[]
  lots            Lot[]
  assets          Asset[]
  sellers         Seller[]
  auctioneers     Auctioneer[]
  judicialProcesses JudicialProcess[]
  bids            Bid[]
  notifications   Notification[]
  subscribers     Subscriber[]
  reports         Report[]
  directSaleOffers DirectSaleOffer[]
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt
}

model User {
  id                    BigInt                 @id @default(autoincrement())
  publicId              String?                @unique
  email                 String                 @unique
  password              String?
  fullName              String?
  cpf                   String?
  rgNumber              String?
  rgIssuer              String?
  rgIssueDate           DateTime?
  rgState               String?
  dateOfBirth           DateTime?
  cellPhone             String?
  homePhone             String?
  gender                String?
  profession            String?
  nationality           String?
  maritalStatus         String?
  propertyRegime        String?
  spouseName            String?
  spouseCpf             String?
  zipCode               String?
  street                String?
  number                String?
  complement            String?
  neighborhood          String?
  city                  String?
  state                 String?
  avatarUrl             String?
  dataAiHint            String?
  habilitationStatus    UserHabilitationStatus @default(PENDING_DOCUMENTS)
  accountType           AccountType            @default(PHYSICAL)
  badges                Json?
  razaoSocial           String?
  cnpj                  String?
  inscricaoEstadual     String?
  website               String?
  responsibleName       String?
  responsibleCpf        String?
  optInMarketing        Boolean?               @default(false)
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  roles                 UsersOnRoles[]
  tenants               UsersOnTenants[]
  documents             UserDocument[]
  bids                  Bid[]
  wins                  UserWin[]
  maxBids               UserLotMaxBid[]
  questions             LotQuestion[]
  reviews               Review[]
  notifications         Notification[]
  uploadedMedia         MediaItem[]            @relation("UploadedBy")
  sellerProfile         Seller?
  auctioneerProfile     Auctioneer?
  wonLots               Lot[]                  @relation("Winner")
}

model Role {
  id            BigInt         @id @default(autoincrement())
  name          String         @unique
  nameNormalized String        @unique
  description   String?
  permissions   Json?
  users         UsersOnRoles[]
}

model UsersOnRoles {
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId     BigInt
  role       Role     @relation(fields: [roleId], references: [id], onDelete: Cascade)
  roleId     BigInt
  assignedAt DateTime @default(now())
  assignedBy String

  @@id([userId, roleId])
  @@index([roleId])
}

model UsersOnTenants {
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId     BigInt
  tenant     Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  tenantId   BigInt
  assignedAt DateTime @default(now())
  assignedBy String?

  @@id([userId, tenantId])
  @@index([tenantId])
}

model PasswordResetToken {
  id        BigInt   @id @default(autoincrement())
  email     String
  token     String   @unique
  expires   DateTime
  createdAt DateTime @default(now())

  @@unique([email, token])
}

model Auction {
  id                        BigInt                 @id @default(autoincrement())
  publicId                  String?                @unique
  slug                      String?                @unique
  title                     String
  description               String?                @db.Text
  status                    AuctionStatus          @default(RASCUNHO)
  auctionDate               DateTime?
  endDate                   DateTime?
  totalLots                 Int                    @default(0)
  visits                    Int                    @default(0)
  totalHabilitatedUsers     Int                    @default(0)
  initialOffer              Decimal?               @db.Decimal(15, 2)
  auctionType               AuctionType?
  auctionMethod             AuctionMethod          @default(STANDARD)
  participation             AuctionParticipation   @default(ONLINE)
  onlineUrl                 String?                @db.VarChar(500)
  address                   String?
  zipCode                   String?                @db.VarChar(10)
  latitude                  Decimal?               @db.Decimal(10, 8)
  longitude                 Decimal?               @db.Decimal(11, 8)
  documentsUrl              String?                @db.VarChar(500)
  isFeaturedOnMarketplace   Boolean                @default(false)
  softCloseEnabled          Boolean?               @default(false)
  softCloseMinutes          Int?
  achievedRevenue           Decimal?               @db.Decimal(15, 2)
  evaluationReportUrl       String?                @db.VarChar(500)
  auctionCertificateUrl     String?                @db.VarChar(500)
  isRelisted                Boolean                @default(false)
  relistCount               Int                    @default(0)
  decrementAmount           Decimal?               @db.Decimal(10, 2)
  decrementIntervalSeconds  Int?
  floorPrice                Decimal?               @db.Decimal(15, 2)
  imageMediaId              String?
  additionalTriggers        String?
  createdAt                 DateTime               @default(now())
  updatedAt                 DateTime               @updatedAt
  tenantId                  BigInt
  auctioneerId              BigInt?
  sellerId                  BigInt?
  cityId                    BigInt?
  stateId                   BigInt?
  judicialProcessId         BigInt?
  originalAuctionId         BigInt?                @unique
  originalAuction           Auction?               @relation("RelistedAuction", fields: [originalAuctionId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  relistedAuction           Auction?               @relation("RelistedAuction")
  auctioneer                Auctioneer?            @relation(fields: [auctioneerId], references: [id], onDelete: SetNull)
  seller                    Seller?                @relation(fields: [sellerId], references: [id], onDelete: SetNull)
  city                      City?                  @relation(fields: [cityId], references: [id], onDelete: SetNull)
  state                     State?                 @relation(fields: [stateId], references: [id], onDelete: SetNull)
  judicialProcess           JudicialProcess?       @relation(fields: [judicialProcessId], references: [id], onDelete: SetNull)
  tenant                    Tenant                 @relation(fields: [tenantId], references: [id], onUpdate: Cascade)
  lots                      Lot[]
  bids                      Bid[]
  questions                 LotQuestion[]
  reviews                   Review[]
  stages                    AuctionStage[]
  habilitations             AuctionHabilitation[]
  categories                LotCategory[]
  courts                    Court[]
  judicialDistricts         JudicialDistrict[]
  judicialBranches          JudicialBranch[]

  @@index([auctioneerId])
  @@index([sellerId])
  @@index([status])
  @@index([auctionType])
  @@index([tenantId])
}

model Lot {
  id                        BigInt                 @id @default(autoincrement())
  publicId                  String?                @unique
  auctionId                 BigInt
  number                    String?
  title                     String
  description               String?                @db.Text
  slug                      String?
  price                     Decimal                @db.Decimal(15, 2)
  initialPrice              Decimal?               @db.Decimal(15, 2)
  secondInitialPrice        Decimal?               @db.Decimal(15, 2)
  bidIncrementStep          Decimal?               @db.Decimal(10, 2)
  status                    LotStatus              @default(EM_BREVE)
  bidsCount                 Int?                   @default(0)
  views                     Int?                   @default(0)
  isFeatured                Boolean?               @default(false)
  isExclusive               Boolean?               @default(false)
  discountPercentage        Int?
  additionalTriggers        Json?
  imageUrl                  String?                @db.Text
  imageMediaId              String?
  galleryImageUrls          Json?
  mediaItemIds              Json?
  type                      String
  condition                 String?
  dataAiHint                String?
  winningBidTermUrl         String?
  allowInstallmentBids      Boolean?               @default(false)
  isRelisted                Boolean                @default(false)
  relistCount               Int                    @default(0)
  createdAt                 DateTime               @default(now())
  updatedAt                 DateTime               @updatedAt
  endDate                   DateTime?
  lotSpecificAuctionDate    DateTime?
  secondAuctionDate         DateTime?
  tenantId                  BigInt
  categoryId                BigInt?
  subcategoryId             BigInt?
  sellerId                  BigInt?
  auctioneerId              BigInt?
  cityId                    BigInt?
  stateId                   BigInt?
  cityName                  String?
  stateUf                   String?
  latitude                  Decimal?
  longitude                 Decimal?
  mapAddress                String?
  mapEmbedUrl               String?                @db.Text
  mapStaticImageUrl         String?                @db.Text
  winnerId                  BigInt?
  auctionDate               DateTime?
  stageDetails              Json?
  auctionName               String?
  evaluationValue           Decimal?               @db.Decimal(15, 2)
  original_lot_id           BigInt?                @unique
  sellerName                String?
  inheritedMediaFromAssetId BigInt?
  auction                   Auction                @relation(fields: [auctionId], references: [id], onDelete: Cascade)
  category                  LotCategory?           @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  subcategory               Subcategory?           @relation(fields: [subcategoryId], references: [id], onDelete: SetNull)
  seller                    Seller?                @relation(fields: [sellerId], references: [id], onDelete: SetNull)
  auctioneer                Auctioneer?            @relation(fields: [auctioneerId], references: [id], onDelete: SetNull)
  city                      City?                  @relation(fields: [cityId], references: [id], onDelete: SetNull)
  state                     State?                 @relation(fields: [stateId], references: [id], onDelete: SetNull)
  winner                    User?                  @relation("Winner", fields: [winnerId], references: [id], onDelete: SetNull)
  tenant                    Tenant                 @relation(fields: [tenantId], references: [id], onUpdate: Cascade)
  originalLot               Lot?                   @relation("RelistedLot", fields: [original_lot_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  relistedLot               Lot?                   @relation("RelistedLot")
  bids                      Bid[]
  assets                    AssetsOnLots[]
  questions                 LotQuestion[]
  reviews                   Review[]
  wins                      UserWin[]
  maxBids                   UserLotMaxBid[]
  installmentPayments       InstallmentPayment[]

  @@unique([auctionId, number])
  @@index([categoryId])
  @@index([subcategoryId])
  @@index([sellerId])
  @@index([auctioneerId])
  @@index([cityId])
  @@index([stateId])
  @@index([winnerId])
  @@index([tenantId])
}

model AuctionStage {
  id           BigInt    @id @default(autoincrement())
  name         String
  startDate    DateTime
  endDate      DateTime
  auctionId    BigInt
  initialPrice Decimal?  @db.Decimal(15, 2)
  auction      Auction   @relation(fields: [auctionId], references: [id], onDelete: Cascade)

  @@index([auctionId])
}

model Auctioneer {
  id                   BigInt      @id @default(autoincrement())
  publicId             String      @unique
  name                 String      @unique
  description          String?     @db.Text
  logoUrl              String?     @db.Text
  logoMediaId          String?
  dataAiHintLogo       String?
  website              String?     @db.Text
  slug                 String      @unique
  registrationNumber   String?
  contactName          String?
  email                String?
  phone                String?
  address              String?
  zipCode              String?
  city                 String?
  state                String?
  createdAt            DateTime    @default(now())
  updatedAt            DateTime    @updatedAt
  userId               BigInt?     @unique
  tenantId             BigInt
  user                 User?       @relation(fields: [userId], references: [id], onDelete: SetNull)
  tenant               Tenant      @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  auctions             Auction[]
  lots                 Lot[]
}

model Seller {
  id               BigInt          @id @default(autoincrement())
  publicId         String          @unique
  name             String          @unique
  description      String?         @db.Text
  logoUrl          String?         @db.Text
  logoMediaId      String?
  dataAiHintLogo   String?
  website          String?         @db.Text
  slug             String          @unique
  isJudicial       Boolean         @default(false)
  contactName      String?
  email            String?
  phone            String?
  address          String?
  zipCode          String?
  city             String?
  state            String?
  createdAt        DateTime        @default(now())
  updatedAt        DateTime        @updatedAt
  userId           BigInt?         @unique
  judicialBranchId BigInt?         @unique
  tenantId         BigInt
  user             User?           @relation(fields: [userId], references: [id], onDelete: SetNull)
  judicialBranch   JudicialBranch? @relation(fields: [judicialBranchId], references: [id], onDelete: SetNull)
  tenant           Tenant          @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  auctions         Auction[]
  lots             Lot[]
  assets           Asset[]
  judicialProcesses JudicialProcess[]
  directSaleOffers  DirectSaleOffer[]
}

model State {
  id        BigInt            @id @default(autoincrement())
  name      String
  uf        String            @unique
  slug      String?           @unique
  cityCount Int?              @default(0)
  createdAt DateTime?         @default(now())
  updatedAt DateTime?         @updatedAt
  cities    City[]
  auctions  Auction[]
  lots      Lot[]
  courts    JudicialDistrict[]
}

model City {
  id        BigInt            @id @default(autoincrement())
  name      String
  slug      String?
  ibgeCode  String?           @unique
  stateId   BigInt
  lotCount  Int?              @default(0)
  createdAt DateTime?         @default(now())
  updatedAt DateTime?         @updatedAt
  state     State             @relation(fields: [stateId], references: [id], onUpdate: Cascade)
  auctions  Auction[]
  lots      Lot[]
}

model Court {
  id                BigInt             @id @default(autoincrement())
  name              String             @unique
  slug              String?            @unique
  stateUf           String?
  website           String?
  createdAt         DateTime?          @default(now())
  updatedAt         DateTime?          @updatedAt
  auctions          Auction[]
  districts         JudicialDistrict[]
  judicialProcesses JudicialProcess[]
}

model JudicialDistrict {
  id                BigInt            @id @default(autoincrement())
  name              String            @unique
  slug              String?           @unique
  zipCode           String?
  createdAt         DateTime?         @default(now())
  updatedAt         DateTime?         @updatedAt
  courtId           BigInt?
  stateId           BigInt?
  auctions          Auction[]
  branches          JudicialBranch[]
  judicialProcesses JudicialProcess[]
  state             State?            @relation(fields: [stateId], references: [id], onDelete: SetNull)
  court             Court?            @relation(fields: [courtId], references: [id], onDelete: SetNull)
}

model JudicialBranch {
  id                BigInt            @id @default(autoincrement())
  name              String            @unique
  slug              String?           @unique
  contactName       String?
  phone             String?
  email             String?
  createdAt         DateTime?         @default(now())
  updatedAt         DateTime?         @updatedAt
  districtId        BigInt?
  auctions          Auction[]
  judicialProcesses JudicialProcess[]
  seller            Seller?
  district          JudicialDistrict? @relation(fields: [districtId], references: [id], onDelete: SetNull)
}

model JudicialProcess {
  id              BigInt          @id @default(autoincrement())
  publicId        String          @unique
  processNumber   String
  isElectronic    Boolean         @default(true)
  createdAt       DateTime?       @default(now())
  updatedAt       DateTime?       @updatedAt
  tenantId        BigInt
  courtId         BigInt?
  districtId      BigInt?
  branchId        BigInt?
  sellerId        BigInt?
  tenant          Tenant          @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  court           Court?          @relation(fields: [courtId], references: [id], onDelete: SetNull)
  district        JudicialDistrict? @relation(fields: [districtId], references: [id], onDelete: SetNull)
  branch          JudicialBranch? @relation(fields: [branchId], references: [id], onDelete: SetNull)
  seller          Seller?         @relation(fields: [sellerId], references: [id], onDelete: SetNull)
  auctions        Auction[]
  assets          Asset[]
  parties         JudicialParty[]
}

model JudicialParty {
  id             BigInt           @id @default(autoincrement())
  name           String
  documentNumber String?
  partyType      ProcessPartyType
  processId      BigInt
  process        JudicialProcess  @relation(fields: [processId], references: [id], onDelete: Cascade)

  @@index([processId])
}

model LotCategory {
  id                  BigInt        @id @default(autoincrement())
  publicId            String?       @unique
  name                String        @unique
  slug                String        @unique
  description         String?       @db.Text
  logoUrl             String?
  logoMediaId         String?
  dataAiHintLogo      String?
  coverImageUrl       String?
  coverImageMediaId   String?
  dataAiHintCover     String?
  megaMenuImageUrl    String?
  megaMenuImageMediaId String?
  dataAiHintMegaMenu  String?
  hasSubcategories    Boolean?      @default(false)
  createdAt           DateTime?     @default(now())
  updatedAt           DateTime?     @updatedAt
  lots                Lot[]
  assets              Asset[]
  subcategories       Subcategory[]
  auctions            Auction[]
  directSaleOffers    DirectSaleOffer[]
}

model Subcategory {
  id                 BigInt      @id @default(autoincrement())
  publicId           String?     @unique
  name               String
  slug               String
  description        String?
  iconUrl            String?
  iconMediaId        String?
  dataAiHintIcon     String?
  displayOrder       Int         @default(0)
  parentCategoryId   BigInt
  parentCategory     LotCategory @relation(fields: [parentCategoryId], references: [id], onDelete: Cascade)
  lots               Lot[]
  assets             Asset[]

  @@unique([name, parentCategoryId])
}

model Bid {
  id            BigInt   @id @default(autoincrement())
  amount        Decimal  @db.Decimal(15, 2)
  timestamp     DateTime @default(now())
  bidderDisplay String?
  auctionId     BigInt
  lotId         BigInt
  bidderId      BigInt
  tenantId      BigInt
  auction       Auction  @relation(fields: [auctionId], references: [id], onDelete: Cascade)
  lot           Lot      @relation(fields: [lotId], references: [id], onDelete: Cascade)
  bidder        User     @relation(fields: [bidderId], references: [id], onDelete: Cascade)
  tenant        Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([lotId])
  @@index([bidderId])
}

model UserWin {
  id               BigInt               @id @default(autoincrement())
  winningBidAmount Decimal              @db.Decimal(15, 2)
  winDate          DateTime             @default(now())
  paymentStatus    PaymentStatus        @default(PENDENTE)
  invoiceUrl       String?
  lotId            BigInt               @unique
  userId           BigInt
  lot              Lot                  @relation(fields: [lotId], references: [id], onUpdate: Cascade)
  user             User                 @relation(fields: [userId], references: [id], onUpdate: Cascade)
  installments     InstallmentPayment[]

  @@index([userId])
}

model InstallmentPayment {
  id                BigInt        @id @default(autoincrement())
  amount            Decimal       @db.Decimal(15, 2)
  dueDate           DateTime
  status            PaymentStatus @default(PENDENTE)
  userWinId         BigInt
  installmentNumber Int
  totalInstallments Int
  paymentDate       DateTime?
  paymentMethod     String?
  transactionId     String?
  userWin           UserWin       @relation(fields: [userWinId], references: [id], onDelete: Cascade)
  Lot               Lot[]

  @@unique([userWinId, installmentNumber])
  @@index([userWinId])
}

model Notification {
  id        BigInt   @id @default(autoincrement())
  message   String
  link      String?
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())
  userId    BigInt
  tenantId  BigInt
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  tenant    Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model Review {
  id              BigInt   @id @default(autoincrement())
  rating          Int
  comment         String?  @db.Text
  createdAt       DateTime @default(now())
  userDisplayName String?
  lotId           BigInt
  auctionId       BigInt
  userId          BigInt
  lot             Lot      @relation(fields: [lotId], references: [id], onDelete: Cascade)
  auction         Auction  @relation(fields: [auctionId], references: [id], onDelete: Cascade)
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([lotId])
}

model LotQuestion {
  id                        BigInt   @id @default(autoincrement())
  questionText              String   @db.Text
  answerText                String?  @db.Text
  isPublic                  Boolean  @default(true)
  createdAt                 DateTime @default(now())
  answeredAt                DateTime?
  userDisplayName           String
  answeredByUserDisplayName String?
  lotId                     BigInt
  auctionId                 BigInt
  userId                    BigInt
  answeredByUserId          BigInt?
  lot                       Lot      @relation(fields: [lotId], references: [id], onDelete: Cascade)
  auction                   Auction  @relation(fields: [auctionId], references: [id], onDelete: Cascade)
  user                      User     @relation(fields: [userId], references: [id], onUpdate: Cascade)

  @@index([lotId])
}

model DocumentType {
  id          BigInt         @id @default(autoincrement())
  name        String         @unique
  description String?
  isRequired  Boolean        @default(true)
  appliesTo   String // e.g., "PHYSICAL,LEGAL,ALL"
  userDocs    UserDocument[]
}

model UserDocument {
  id              BigInt         @id @default(autoincrement())
  status          DocumentStatus @default(PENDING_ANALYSIS)
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  verifiedAt      DateTime?
  userId          BigInt
  documentTypeId  BigInt
  fileName        String?
  fileUrl         String
  rejectionReason String?
  user            User           @relation(fields: [userId], references: [id], onDelete: Cascade)
  documentType    DocumentType   @relation(fields: [documentTypeId], references: [id], onUpdate: Cascade)

  @@unique([userId, documentTypeId])
  @@index([userId])
}

model UserLotMaxBid {
  id        BigInt   @id @default(autoincrement())
  createdAt DateTime @default(now())
  userId    BigInt
  lotId     BigInt
  isActive  Boolean  @default(true)
  maxAmount Decimal  @db.Decimal(15, 2)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  lot       Lot      @relation(fields: [lotId], references: [id], onDelete: Cascade)

  @@unique([userId, lotId])
  @@index([lotId])
}

model DirectSaleOffer {
  id                   BigInt                @id @default(autoincrement())
  publicId             String                @unique
  title                String
  description          String?               @db.Text
  offerType            DirectSaleOfferType
  price                Decimal?              @db.Decimal(15, 2)
  minimumOfferPrice    Decimal?              @db.Decimal(15, 2)
  status               DirectSaleOfferStatus @default(ACTIVE)
  locationCity         String?
  locationState        String?
  imageUrl             String?
  imageMediaId         String?
  dataAiHint           String?
  galleryImageUrls     Json?
  mediaItemIds         Json?
  itemsIncluded        Json?
  views                Int                   @default(0)
  expiresAt            DateTime?
  createdAt            DateTime              @default(now())
  updatedAt            DateTime              @updatedAt
  tenantId             BigInt
  sellerId             BigInt
  sellerName           String?
  sellerLogoUrl        String?
  dataAiHintSellerLogo String?
  categoryId           BigInt
  tenant               Tenant                @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  seller               Seller                @relation(fields: [sellerId], references: [id], onDelete: Cascade)
  category             LotCategory           @relation(fields: [categoryId], references: [id])
}

model ContactMessage {
  id        BigInt   @id @default(autoincrement())
  name      String
  email     String
  subject   String?
  message   String   @db.Text
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())
}

model Subscriber {
  id          BigInt   @id @default(autoincrement())
  email       String   @unique
  name        String?
  phone       String?
  preferences Json?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  tenantId    BigInt
  tenant      Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
}

model VehicleMake {
  id     BigInt         @id @default(autoincrement())
  name   String         @unique
  slug   String         @unique
  models VehicleModel[]
}

model VehicleModel {
  id     BigInt      @id @default(autoincrement())
  name   String
  slug   String
  makeId BigInt
  make   VehicleMake @relation(fields: [makeId], references: [id], onDelete: Cascade)

  @@unique([makeId, name])
  @@index([slug])
}

model AuctionHabilitation {
  userId      BigInt
  auctionId   BigInt
  habilitatedAt DateTime @default(now())
  user        User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  auction     Auction    @relation(fields: [auctionId], references: [id], onDelete: Cascade)

  @@id([userId, auctionId])
  @@index([auctionId])
}
