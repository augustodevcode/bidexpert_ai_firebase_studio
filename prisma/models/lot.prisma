model Lot {
  id                 BigInt   @id @default(autoincrement())
  publicId           String   @unique @default(cuid())
  number             String?
  title              String
  slug               String   @unique
  description        String?  @db.Text
  properties         Json?
  
  status             String   @default("EM_BREVE")
  
  price              Decimal  @db.Decimal(12, 2)
  initialPrice       Decimal? @db.Decimal(12, 2)
  secondInitialPrice Decimal? @db.Decimal(12, 2)
  reservePrice       Decimal? @db.Decimal(12, 2)
  bidIncrementStep   Decimal? @db.Decimal(12, 2)
  
  // Location
  cityName        String?
  stateUf         String?
  mapAddress      String?
  latitude        Decimal? @db.Decimal(9, 6)
  longitude       Decimal? @db.Decimal(9, 6)
  
  // Media
  imageUrl          String?
  imageMediaId      String?
  videoUrl          String?
  inheritedMediaFromBemId BigInt?

  // Stats
  bidsCount         Int      @default(0)
  views             Int      @default(0)
  
  // Features
  isFeatured        Boolean  @default(false)
  isExclusive       Boolean  @default(false)
  allowInstallmentBids Boolean @default(true)
  additionalTriggers  String[]
  discountPercentage  Int?
  dataAiHint        String?

  // Timestamps and Relations
  auctionDate       DateTime?
  endDate           DateTime?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  
  tenantId    BigInt
  tenant      Tenant     @relation(fields: [tenantId], references: [id])
  auctionId   BigInt
  auction     Auction    @relation(fields: [auctionId], references: [id])
  categoryId  BigInt
  category    LotCategory @relation(fields: [categoryId], references: [id])
  subcategoryId BigInt?
  subcategory Subcategory? @relation(fields: [subcategoryId], references: [id])
  
  sellerId BigInt?
  seller   Seller? @relation(fields: [sellerId], references: [id])
  
  auctioneerId BigInt?
  auctioneer   Auctioneer? @relation(fields: [auctioneerId], references: [id])
  
  winnerId BigInt?
  winner   User?      @relation("WonLots", fields: [winnerId], references: [id])

  // Relisting Info
  isRelisted    Boolean  @default(false)
  relistCount   Int      @default(0)
  originalLotId BigInt?
  originalLot   Lot?     @relation("RelistHistory", fields: [originalLotId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  relistedLots  Lot[]    @relation("RelistHistory")

  assets          AssetsOnLots[]
  bids            Bid[]
  userLotMaxBids  UserLotMaxBid[]
  reviews         Review[]
  questions       LotQuestion[]
  installments    InstallmentPayment[]
  win             UserWin?
  
  city   City? @relation(fields: [cityId], references: [id])
  cityId BigInt?
  state  State? @relation(fields: [stateId], references: [id])
  stateId BigInt?

  stagePrices LotStagePrice[]

  @@index([auctionId])
  @@index([status])
}
