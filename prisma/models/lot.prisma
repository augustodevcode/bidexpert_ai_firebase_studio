// /prisma/models/lot.prisma

model Lot {
  id                      String    @id @default(cuid())
  publicId                String    @unique @default(cuid())
  auctionId               String
  slug                    String?
  number                  String?
  title                   String
  description             String?   @db.Text
  price                   Decimal   @default(0) @db.Decimal(15, 2)
  initialPrice            Decimal?  @db.Decimal(15, 2)
  secondInitialPrice      Decimal?  @db.Decimal(15, 2)
  bidIncrementStep        Decimal?  @db.Decimal(10, 2)
  status                  LotStatus @default(EM_BREVE)
  bidsCount               Int       @default(0)
  views                   Int       @default(0)
  isFeatured              Boolean   @default(false)
  isExclusive             Boolean   @default(false)
  discountPercentage      Int?
  additionalTriggers      Json?
  imageUrl                String?
  imageMediaId            String?
  galleryImageUrls        Json?
  mediaItemIds            Json?
  type                    String
  categoryId              String?
  subcategoryId           String?
  auctionName             String?
  sellerId                String?
  sellerName              String?
  auctioneerId            String?
  cityId                  String?
  stateId                 String?
  cityName                String?
  stateUf                 String?
  latitude                Decimal?  @db.Decimal(10, 8)
  longitude               Decimal?  @db.Decimal(11, 8)
  mapAddress              String?
  mapEmbedUrl             String?
  mapStaticImageUrl       String?
  endDate                 DateTime?
  auctionDate             DateTime?
  lotSpecificAuctionDate  DateTime?
  secondAuctionDate       DateTime?
  condition               String?
  dataAiHint              String?
  winnerId                String?
  winningBidTermUrl       String?
  allowInstallmentBids    Boolean   @default(false)
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt
  tenantId                String
  isRelisted              Boolean   @default(false)
  relistCount             Int       @default(0)
  originalLotId           String?
  inheritedMediaFromAssetId String?

  assets        AssetsOnLots[]
  originalLot   Lot?           @relation("RelistedLots", fields: [originalLotId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  relistedLots  Lot[]          @relation("RelistedLots")
  auction       Auction        @relation(fields: [auctionId], references: [id], onDelete: Cascade)
  category      LotCategory?   @relation(fields: [categoryId], references: [id])
  subcategory   Subcategory?   @relation(fields: [subcategoryId], references: [id])
  seller        Seller?        @relation(fields: [sellerId], references: [id])
  city          City?          @relation(fields: [cityId], references: [id])
  state         State?         @relation(fields: [stateId], references: [id])
  auctioneer    Auctioneer?    @relation(fields: [auctioneerId], references: [id])
  winner        User?          @relation("WonLots", fields: [winnerId], references: [id])
  bids          Bid[]
  questions     LotQuestion[]
  reviews       Review[]
  userMaxBids   UserLotMaxBid[]
  userWins      UserWin[]
  tenant        Tenant         @relation(fields: [tenantId], references: [id])

  @@index([auctionId])
  @@index([categoryId])
  @@index([sellerId])
  @@index([winnerId])
  @@index([tenantId])
}
