model Lot {
  id              BigInt    @id @default(autoincrement())
  publicId        String    @unique @default(cuid())
  slug            String    @unique @default(cuid())
  auctionId       BigInt
  number          String?
  title           String
  description     String?   @db.Text
  price           Decimal   @db.Decimal(12, 2)
  initialPrice    Decimal?  @db.Decimal(12, 2)
  secondInitialPrice Decimal? @db.Decimal(12, 2)
  bidIncrementStep Decimal? @db.Decimal(10, 2)
  status          LotStatus @default(EM_BREVE)
  dataAiHint      String?
  views           Int       @default(0)
  bidsCount       Int       @default(0)
  isFeatured      Boolean   @default(false)
  isExclusive     Boolean   @default(false)
  allowInstallmentBids Boolean @default(true)
  winnerId        String?
  winningBidTermUrl String?

  imageUrl        String?
  imageMediaId    String?

  // Relacionamento com Ativos/Bens
  assets AssetsOnLots[]

  // Relacionamentos com localização
  street         String?
  number         String?
  complement     String?
  neighborhood   String?
  zipCode        String?
  latitude       Decimal?
  longitude      Decimal?
  cityId         BigInt?
  stateId        BigInt?
  mapAddress     String?

  // Relacionamentos
  auction         Auction          @relation(fields: [auctionId], references: [id])
  bids            Bid[]
  winner          User?            @relation(name: "LotWinner", fields: [winnerId], references: [id], onDelete: SetNull, onUpdate: Cascade)
  maxBids         UserLotMaxBid[]
  reviews         Review[]
  questions       LotQuestion[]
  installments    InstallmentPayment[]
  stagePrices     LotStagePrice[]

  // Relacionamentos Categoriais
  type            String?
  categoryId      BigInt?
  subcategoryId   BigInt?
  category        LotCategory?    @relation(fields: [categoryId], references: [id])
  subcategory     Subcategory?    @relation(fields: [subcategoryId], references: [id])
  
  // Relacionamentos de Proprietário
  sellerId        BigInt?
  auctioneerId    BigInt?
  seller          Seller?         @relation(fields: [sellerId], references: [id])
  auctioneer      Auctioneer?     @relation(fields: [auctioneerId], references: [id])

  // Relacionamentos Judiciais
  judicialProcessNumber String?
  courtName             String?
  courtDistrict         String?
  propertyRegistrationNumber String?
  propertyLiens         String?   @db.Text
  knownDebts            String?   @db.Text
  additionalDocumentsInfo String? @db.Text

  // Relacionamento de Relistagem
  originalLotId   BigInt?         @unique
  isRelisted      Boolean         @default(false)
  relistCount     Int             @default(0)
  originalLot     Lot?            @relation("RelistedLot", fields: [originalLotId], references: [id])
  relistedVersion Lot?            @relation("RelistedLot")

  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  
  tenantId        String
  tenant          Tenant          @relation(fields: [tenantId], references: [id])

  @@index([auctionId])
  @@index([status])
  @@index([winnerId])
  @@index([sellerId])
  @@index([categoryId])
}
